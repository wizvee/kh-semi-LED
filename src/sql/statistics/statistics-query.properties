forWageLine=SELECT YYYY,SUM("01"), SUM("02"), SUM("03"), SUM("04"), SUM("05"), SUM("06"),SUM("07"), SUM("08"), SUM("09"), SUM("10"), SUM("11"), SUM("12") FROM ( SELECT extract(YEAR from to_date(ATD_ON,'yyyymmddhh24mi')) AS YYYY, decode(extract(MONTH from to_date(ATD_ON,'yyyymmddhh24mi')),'1',SUM(ATD_WAGE),0)as "01", decode(extract(MONTH from to_date(ATD_ON,'yyyymmddhh24mi')),'2',SUM(ATD_WAGE),0)as "02", decode(extract(MONTH from to_date(ATD_ON,'yyyymmddhh24mi')),'3',SUM(ATD_WAGE),0)as "03", decode(extract(MONTH from to_date(ATD_ON,'yyyymmddhh24mi')),'4',SUM(ATD_WAGE),0)as "04", decode(extract(MONTH from to_date(ATD_ON,'yyyymmddhh24mi')),'5',SUM(ATD_WAGE),0)as "05", decode(extract(MONTH from to_date(ATD_ON,'yyyymmddhh24mi')),'6',SUM(ATD_WAGE),0)as "06", decode(extract(MONTH from to_date(ATD_ON,'yyyymmddhh24mi')),'7',SUM(ATD_WAGE),0)as "07", decode(extract(MONTH from to_date(ATD_ON,'yyyymmddhh24mi')),'8',SUM(ATD_WAGE),0)as "08", decode(extract(MONTH from to_date(ATD_ON,'yyyymmddhh24mi')),'9',SUM(ATD_WAGE),0)as "09", decode(extract(MONTH from to_date(ATD_ON,'yyyymmddhh24mi')),'10',SUM(ATD_WAGE),0)as "10", decode(extract(MONTH from to_date(ATD_ON,'yyyymmddhh24mi')),'11',SUM(ATD_WAGE),0)as "11", decode(extract(MONTH from to_date(ATD_ON,'yyyymmddhh24mi')),'12',SUM(ATD_WAGE),0)as "12" FROM ATTENDANCE_TB  WHERE BUS_ID=? group by extract(YEAR from to_date(ATD_ON,'yyyymmddhh24mi')), extract(MONTH from to_date(ATD_ON,'yyyymmddhh24mi'))) GROUP BY YYYY ORDER BY 1
forWageTable=SELECT USER_NAME,SUM(ATD_WAGE),EMP_END FROM ATTENDANCE_TB JOIN BUS_EMP_TB USING (EMP_ID) JOIN USER_TB ON (EMP_ID = USER_ID) WHERE ATTENDANCE_TB.BUS_ID=? GROUP BY USER_NAME,EMP_END ORDER BY 3 DESC
forTimeLine=SELECT USER_NAME, EMP_START, EMP_END FROM BUS_EMP_TB JOIN USER_TB ON (EMP_ID = USER_ID) WHERE BUS_EMP_TB.BUS_ID=? ORDER BY 2
forWorkingHour=SELECT YYYY,SUM("01"), SUM("02"), SUM("03"), SUM("04"), SUM("05"), SUM("06"),SUM("07"), SUM("08"), SUM("09"), SUM("10"), SUM("11"), SUM("12")FROM (SELECT extract(YEAR from to_date(ATD_ON,'yyyymmddhh24mi')) AS YYYY,decode(extract(MONTH from to_date(ATD_ON,'yyyymmddhh24mi')),'1',SUM(ATD_TIME),0)as "01",decode(extract(MONTH from to_date(ATD_ON,'yyyymmddhh24mi')),'2',SUM(ATD_TIME),0)as "02",decode(extract(MONTH from to_date(ATD_ON,'yyyymmddhh24mi')),'3',SUM(ATD_TIME),0)as "03",decode(extract(MONTH from to_date(ATD_ON,'yyyymmddhh24mi')),'4',SUM(ATD_TIME),0)as "04",decode(extract(MONTH from to_date(ATD_ON,'yyyymmddhh24mi')),'5',SUM(ATD_TIME),0)as "05",decode(extract(MONTH from to_date(ATD_ON,'yyyymmddhh24mi')),'6',SUM(ATD_TIME),0)as "06",decode(extract(MONTH from to_date(ATD_ON,'yyyymmddhh24mi')),'7',SUM(ATD_TIME),0)as "07",decode(extract(MONTH from to_date(ATD_ON,'yyyymmddhh24mi')),'8',SUM(ATD_TIME),0)as "08",decode(extract(MONTH from to_date(ATD_ON,'yyyymmddhh24mi')),'9',SUM(ATD_TIME),0)as "09",decode(extract(MONTH from to_date(ATD_ON,'yyyymmddhh24mi')),'10',SUM(ATD_TIME),0)as "10",decode(extract(MONTH from to_date(ATD_ON,'yyyymmddhh24mi')),'11',SUM(ATD_TIME),0)as "11",decode(extract(MONTH from to_date(ATD_ON,'yyyymmddhh24mi')),'12',SUM(ATD_TIME),0)as "12" FROM ATTENDANCE_TB  WHERE BUS_ID=? group by extract(YEAR from to_date(ATD_ON,'yyyymmddhh24mi')), extract(MONTH from to_date(ATD_ON,'yyyymmddhh24mi'))) GROUP BY YYYY ORDER BY 1
forTotalEmp=SELECT YYYY,SUM("01"), SUM("02"), SUM("03"), SUM("04"), SUM("05"), SUM("06"),SUM("07"), SUM("08"), SUM("09"), SUM("10"), SUM("11"), SUM("12")FROM (SELECT extract(YEAR from to_date(ATD_ON,'yyyymmddhh24mi')) AS YYYY,decode(extract(MONTH from to_date(ATD_ON,'yyyymmddhh24mi')),'1',COUNT(EMP_ID),0)as "01",decode(extract(MONTH from to_date(ATD_ON,'yyyymmddhh24mi')),'2',COUNT(EMP_ID),0)as "02",decode(extract(MONTH from to_date(ATD_ON,'yyyymmddhh24mi')),'3',COUNT(EMP_ID),0)as "03",decode(extract(MONTH from to_date(ATD_ON,'yyyymmddhh24mi')),'4',COUNT(EMP_ID),0)as "04",decode(extract(MONTH from to_date(ATD_ON,'yyyymmddhh24mi')),'5',COUNT(EMP_ID),0)as "05",decode(extract(MONTH from to_date(ATD_ON,'yyyymmddhh24mi')),'6',COUNT(EMP_ID),0)as "06",decode(extract(MONTH from to_date(ATD_ON,'yyyymmddhh24mi')),'7',COUNT(EMP_ID),0)as "07",decode(extract(MONTH from to_date(ATD_ON,'yyyymmddhh24mi')),'8',COUNT(EMP_ID),0)as "08",decode(extract(MONTH from to_date(ATD_ON,'yyyymmddhh24mi')),'9',COUNT(EMP_ID),0)as "09",decode(extract(MONTH from to_date(ATD_ON,'yyyymmddhh24mi')),'10',COUNT(EMP_ID),0)as "10",decode(extract(MONTH from to_date(ATD_ON,'yyyymmddhh24mi')),'11',COUNT(EMP_ID),0)as "11",decode(extract(MONTH from to_date(ATD_ON,'yyyymmddhh24mi')),'12',COUNT(EMP_ID),0)as "12" FROM ATTENDANCE_TB  WHERE BUS_ID=? group by extract(YEAR from to_date(ATD_ON,'yyyymmddhh24mi')),extract(MONTH from to_date(ATD_ON,'yyyymmddhh24mi'))) GROUP BY YYYY ORDER BY 1