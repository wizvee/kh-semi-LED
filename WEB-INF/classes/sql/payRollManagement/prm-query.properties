makePayRollList = select USER_NAME NAME, SUM(ATD_WAGE) PAY, SUM(ATD_TIME) WORK, COUNT(CASE WHEN ATD_TYPE LIKE '%L%' THEN 1 END) LATE, COUNT(CASE WHEN ATD_TYPE LIKE '%E%' THEN 1 END) EARLY from ATTENDANCE_TB JOIN BUS_EMP_TB USING(EMP_ID) JOIN USER_TB ON(EMP_ID = USER_ID) where TO_DATE(SUBSTR(ATD_ON,1,8),'yyyymmdd') between ADD_MONTHS(TRUNC(SYSDATE,'MM'), - ?) AND SYSDATE AND ATTENDANCE_TB.BUS_ID = ? AND EMP_TYPE = ? GROUP BY USER_NAME
